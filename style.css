/* スタイルは変更なし */
  body { margin: 0; overflow: hidden; background: #1a1a1a; color: white; font-family: 'Hiragino Kaku Gothic ProN', sans-serif; touch-action: none; user-select: none; -webkit-user-select: none; }
  canvas { display: block; }
  
  /* UI表示 */
  #hud { position: absolute; top: 10px; left: 10px; z-index: 10; pointer-events: none; text-shadow: 1px 1px 0 #000; font-weight: bold; }
  .bar-container { width: 150px; height: 10px; background: #444; border: 1px solid #fff; margin-bottom: 5px; position: relative; }
  .bar-fill { height: 100%; width: 100%; transition: width 0.2s; }
  #hp-bar { background: #ff4444; }
  #exp-bar { background: #00d2ff; width: 0%; }
  #event-message { color: gold; font-size: 18px; text-align: center; margin-top: 5px; }

  /* イベントアニメーション追加 */
  #event-animation-overlay {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-color: transparent;
    pointer-events: none;
    opacity: 0;
    z-index: 15; 
    transition: opacity 0.1s ease-out;
  }
  .event-flash {
    animation: flash-fade 0.5s ease-out forwards;
  }
  @keyframes flash-fade {
    0% { opacity: 0.8; }
    100% { opacity: 0; }
  }
  
  /* レベルアップ画面 */
  #levelup-screen { 
    display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
    background: rgba(0,0,0,0.85); z-index: 20; flex-direction: column; justify-content: center; align-items: center;
  }
  #levelup-title { font-size: 30px; color: gold; margin-bottom: 20px; animation: pulse 1s infinite alternate; }
  .card-container { display: flex; flex-direction: column; gap: 15px; width: 90%; max-width: 400px; }
  .card { 
    background: #333; border: 2px solid #fff; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; 
    transition: transform 0.1s;
  }
  .card:active { transform: scale(0.98); background: #444; }
  .card-icon { width: 40px; height: 40px; background: #555; margin-right: 15px; display: flex; justify-content: center; align-items: center; font-size: 20px; border-radius: 5px;}
  .card-info h3 { margin: 0 0 5px 0; font-size: 18px; color: #ffeb3b; }
  .card-info p { margin: 0; font-size: 12px; color: #ccc; }
  .rarity-rare { border-color: gold; background: #442200; }
  .inventory-display {
    background: #111; padding: 10px; border-radius: 5px; margin-bottom: 20px;
    width: 90%; max-width: 400px; text-align: center;
  }
  .inv-list-item { display: inline-block; margin: 0 5px; font-size: 14px; }

  @keyframes pulse { from { transform: scale(1); } to { transform: scale(1.1); } }